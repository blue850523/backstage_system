(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ced8874"],{2157:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.size},[a("div",{staticClass:"form-group row nopadding"},[a("div",{staticClass:"nopadding",class:t.label_size},[a("div",{staticClass:"filter-title"},[a("label",{staticClass:"control-label",attrs:{for:t.id}},[t._v(t._s(t.label))])])]),a("div",{staticClass:"nopadding",class:t.customization_size},[t._t("default")],2)])])},s=[],r={name:"filter_customization",props:{label:{type:String,default:"請傳入label"},name:{type:String,default:"請傳入name"},id:{type:String,default:""},size:{type:String,default:"col-md-3"},label_size:{type:String,default:"col-5"},customization_size:{type:String,default:"col-5"}}},i=r,o=a("2877"),c=Object(o["a"])(i,n,s,!1,null,null,null);e["a"]=c.exports},"38f5":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form-group",class:t.get_classes()},[t.label&&t.label.length?a("label",{staticClass:"control-label",class:t.get_label_class(),staticStyle:{"":":before"},on:{click:function(e){t.clickable_label&&t.$emit("label-click")}}},[t._v(" "+t._s(t.label)+" ")]):t._e(),t._t("default")],2)},s=[],r={name:"tc_form_group",props:{hasError:{type:Boolean,default:!1},required:{type:Boolean,default:!1},grid_col_md_2:{type:Boolean,default:!1},label:{type:String,default:""},clickable_label:{type:Boolean,default:!1}},methods:{get_classes:function(){return{"has-error":this.hasError,"has-custom-error":this.hasError,required:this.required,"grid-col-md-2":this.grid_col_md_2,"not-required":!this.required}},get_label_class:function(){return{"as-link":this.clickable_label}}}},i=r,o=(a("97c0"),a("2877")),c=Object(o["a"])(i,n,s,!1,null,null,null);e["a"]=c.exports},"65ff":function(t,e,a){"use strict";a("b09a")},"6de5":function(t,e,a){"use strict";a("f6e9")},8475:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("select",{staticClass:"form-select",attrs:{disabled:t.disabled},on:{change:function(e){t.change(e),t.validate}}},[t.allowEmpty?a("option",{domProps:{value:t.emptyValue}},[t._v(t._s(t.emptyText))]):t._e(),t._t("default",(function(){return t._l(t.options,(function(e,n){return a("option",{key:n,attrs:{disabled:e.disabled},domProps:{value:e.value,selected:e.value===t.value}},[t._v(" "+t._s(e.text||e.name)+" ")])}))}))],2)},s=[],r=(a("a9e3"),{name:"TCDropdown",model:{prop:"value",event:"change"},props:{value:null,options:{type:Array,default:function(){return[{text:"請傳入資料 須包含text或name 以及value",value:"",disabled:!1}]}},allowEmpty:{type:Boolean,default:!0},emptyText:{type:String,default:""},emptyValue:{type:[String,Number,Object,Boolean,null],default:null},validate:Function,disabled:Boolean},methods:{change:function(t){this.$emit("change",t.target.value)}}}),i=r,o=a("2877"),c=Object(o["a"])(i,n,s,!1,null,null,null);e["a"]=c.exports},"97c0":function(t,e,a){"use strict";a("e31f")},aa56:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"accmanage"},[a("div",{staticClass:"vc-panel",attrs:{id:"main-panel"}},[a("div",{staticClass:"vc-panel-heading"},[a("span",{staticClass:"vc-panel-title"},[t._v("內部文件")]),a("div",{staticClass:"pull-right"},[a("button",{staticClass:"btn btn-new",attrs:{id:"AccManagement_AccManage_Btn_CreateAcc"},on:{click:t.addInternal}},[t._v(" 新增內部文件 ")])])]),a("div",{staticClass:"vc-panel-body"},[a("form",{staticClass:"vc-panel-body-search watermark-container",attrs:{id:"search-panel"}},[a("WaterMark"),a("div",{staticClass:"subTitle",staticStyle:{"justify-content":"space-between"}},[t._v(" 選擇搜尋條件 ")]),a("div",{staticClass:"vc-panel-body-search-row row row-cols-4 gx-0 gy-1"},[a("FilterInputField",{attrs:{label:t.$t("acc_loan_doc.account_no"),name:"filter_account_no",id:"id_account_no",only_number:""},model:{value:t.filters.account_no,callback:function(e){t.$set(t.filters,"account_no",e)},expression:"filters.account_no"}}),a("FilterInputField",{attrs:{label:t.$t("acc_loan_doc.doc_type"),name:"filter_doc_type",id:"id_doc_type"},model:{value:t.filters.doc_type,callback:function(e){t.$set(t.filters,"doc_type",e)},expression:"filters.doc_type"}}),a("FilterInputField",{attrs:{label:t.$t("acc_loan_doc.signatory_or_guarantor_name"),name:"filter_signatory_or_guarantor_name",id:"id_signatory_or_guarantor_name"},model:{value:t.filters.signatory_or_guarantor_name,callback:function(e){t.$set(t.filters,"signatory_or_guarantor_name",e)},expression:"filters.signatory_or_guarantor_name"}}),a("FilterInputField",{attrs:{label:t.$t("acc_loan_doc.remark"),name:"filter_remark",id:"id_remark"},model:{value:t.filters.remark,callback:function(e){t.$set(t.filters,"remark",e)},expression:"filters.remark"}}),a("FilterSelectField",{attrs:{label:t.$t("acc_loan_doc.track_status"),name:"filter_track_status",id:"id_track_status",options:t.track_status_options},model:{value:t.filters.track_status,callback:function(e){t.$set(t.filters,"track_status",e)},expression:"filters.track_status"}})],1),a("div",{staticClass:"vc-panel-body-search-row row g-0"},[a("div",{staticClass:"col text-end"},[a("button",{staticClass:"btn btn-primary",staticStyle:{"margin-right":"4px"},attrs:{type:"button"},on:{click:function(e){return t.search()}}},[t._v(" 搜尋 ")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"reset"}},[t._v(" 重置 ")])])])],1),a("div",{staticClass:"vc-panel-body-list",attrs:{id:"list-panel"}},[a("div",{staticClass:"subTitle",staticStyle:{"justify-content":"space-between"}},[t._v(" 檢視搜尋結果 "),a("div",{staticClass:"text-end"},[a("button",{staticClass:"btn btn-new5",staticStyle:{"margin-left":"4px"},on:{click:t.select_display_fields}},[t._v(" 篩選顯示 ")]),a("button",{staticClass:"btn btn-new2",staticStyle:{"margin-left":"4px"}},[t._v(" 列印 ")]),a("button",{staticClass:"btn btn-new3",staticStyle:{"margin-left":"4px"}},[t._v(" 匯出EXCEL ")])])]),a("div",{staticClass:"vc-panel-body-list-table"},[a("div",{staticClass:"table-container watermark-container"},[a("WaterMark"),a("div",{ref:"thead",staticClass:"table-responsive nopadding thead"},[a("table",{staticClass:"table table-bordered"},[a("thead",[a("tr",{staticClass:"table-title-bar"},[a("th",{staticClass:"text-center field-scale-1"},[t._v(" 操作 ")]),t._l(t.filter_fields,(function(e){return a("th",{key:e.key,staticClass:"text-center",class:"field-scale-"+e.scale},[t._v(" "+t._s(e.label)+" ")])}))],2)])])]),a("div",{ref:"tbody",staticClass:"table-responsive nopadding tbody",on:{scroll:function(e){return t.sync_thead_scroll()}}},[a("table",{staticClass:"table table-bordered table-hover"},[a("tbody",t._l(t.list,(function(e,n){return a("tr",{key:n,class:{selectedTr:t.selected_index.includes(n)},on:{click:function(e){return t.handle_acitve_tr(n)}}},[a("td",{staticClass:"text-center field-scale-1"},[a("button",{staticClass:"btn btn-w btn-mr4",attrs:{type:"button"},on:{click:function(a){return t.edit(e.id)}}},[t._v(" 修改 ")])]),t._l(t.filter_fields,(function(n){return a("td",{key:n.key,staticClass:"text-left",class:"field-scale-"+n.scale},[t._v(" "+t._s(e[n.key])+" ")])}))],2)})),0)])])],1)])])]),a("Pagination",{ref:"page",on:{searchService:t.pageSearch}})],1),a("div",[a("DisplayColumn",{ref:"displayColumn",attrs:{fields:t.fields},on:{hidden_fields:t.getHiddenFields}}),a("EditForm",{ref:"editForm"})],1)])},s=[],r=a("1da1"),i=a("5530"),o=a("2909"),c=(a("96cf"),a("d3b7"),a("159b"),a("caad"),a("2532"),a("99af"),a("ac1f"),a("841c"),a("a434"),a("3ea2")),l=a("1746"),d=a("4264"),u=a("2157"),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("TCModal",{ref:"modal",staticClass:"edit_form",attrs:{id:"edit_form",title:t.UI.title,dialog_width:"1600px","modal-body-style":{"min-height":"fit-content","max-height":"auto",overflow:"auto"}},scopedSlots:t._u([{key:"body",fn:function(){return[n("div",{staticClass:"step-list-area"},[n("ul",{staticClass:"nav nav-pills step-list",attrs:{role:"tablist"}},t._l(t.step_tab_list,(function(e,a){return n("li",{key:e.id,staticClass:"nav-item step-btn",attrs:{role:"presentation"}},[n("button",{staticClass:"nav-link",attrs:{id:e.id+"-tab","data-bs-toggle":"pill","data-bs-target":"#"+e.id,type:"button","aria-controls":""+e.id,role:"tab"}},[t._v(" "+t._s(a+1)+" "),n("div",{staticClass:"step-title"},[t._v(t._s(e.title))])])])})),0)]),n("div",{staticClass:"tab-content main-tab-content"},[n("div",{staticClass:"tab-pane fade",attrs:{id:"step1"}},[n("div",{staticClass:"subTitle justify-content-between"},[t._v("戶口")]),n("div",{staticClass:"row gx-0 gy-1"},[n("div",{staticClass:"col-4 row"},[n("TCFormGroup",{staticClass:"col-4",attrs:{label:"戶口編號",required:""}}),n("TCFormGroup",{staticClass:"col-6",attrs:{required:""}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.records.document.account_no,expression:"records.document.account_no"},{name:"tc-number",rawName:"v-tc-number"}],staticClass:"form-control",attrs:{placeholder:"戶口編號"},domProps:{value:t.records.document.account_no},on:{blur:function(e){return t.getAccName(e)},input:function(e){e.target.composing||t.$set(t.records.document,"account_no",e.target.value)}}})])],1),n("div",{staticClass:"col-4 row"},[n("TCFormGroup",{staticClass:"col-4",attrs:{label:"姓名"}}),n("TCFormGroup",{staticClass:"col-6"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.records.document.account_name,expression:"records.document.account_name"}],staticClass:"form-control",attrs:{placeholder:"姓名",disabled:""},domProps:{value:t.records.document.account_name},on:{input:function(e){e.target.composing||t.$set(t.records.document,"account_name",e.target.value)}}})])],1)]),n("div",{staticClass:"subTitle justify-content-between"},[t._v("文件")]),n("div",{staticClass:"row gx-0 gy-1"},[n("div",{staticClass:"col-4 row"},[n("TCFormGroup",{staticClass:"col-4",attrs:{label:"文件類型",required:""}}),n("TCFormGroup",{staticClass:"col-6",attrs:{required:""}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.records.document.doc_type,expression:"records.document.doc_type"}],staticClass:"form-control",attrs:{placeholder:"文件類型"},domProps:{value:t.records.document.doc_type},on:{input:function(e){e.target.composing||t.$set(t.records.document,"doc_type",e.target.value)}}})])],1),n("div",{staticClass:"col-4 row"},[n("TCFormGroup",{staticClass:"col-4",attrs:{label:"生效日期",required:""}}),n("TCFormGroup",{staticClass:"col-6"},[n("DatePicker",{attrs:{type:"date","value-type":"format",placeholder:"生效日期"},model:{value:t.records.document.effective_date,callback:function(e){t.$set(t.records.document,"effective_date",e)},expression:"\n                                        records.document.effective_date\n                                    "}})],1)],1),n("div",{staticClass:"col-4 row"},[n("TCFormGroup",{staticClass:"col-4",attrs:{label:"文件金額(萬)",required:""}}),n("TCFormGroup",{staticClass:"col-6",attrs:{required:""}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.records.document.amount,expression:"records.document.amount"},{name:"tc-money",rawName:"v-tc-money"}],staticClass:"form-control",attrs:{placeholder:"文件金額(萬)"},domProps:{value:t.records.document.amount},on:{input:function(e){e.target.composing||t.$set(t.records.document,"amount",e.target.value)}}})])],1),n("div",{staticClass:"col-4 row"},[n("TCFormGroup",{staticClass:"col-4",attrs:{label:"簽署人",required:"",clickable_label:!0},nativeOn:{click:function(e){return t.showSignatoryProfile.apply(null,arguments)}}}),n("TCFormGroup",{staticClass:"col-6",attrs:{required:""}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.records.document.signatory_profile_name,expression:"\n                                        records.document\n                                            .signatory_profile_name\n                                    "}],staticClass:"form-control",attrs:{placeholder:"簽署人",disabled:""},domProps:{value:t.records.document.signatory_profile_name},on:{input:function(e){e.target.composing||t.$set(t.records.document,"signatory_profile_name",e.target.value)}}})])],1),n("div",{staticClass:"col-4 row"},[n("TCFormGroup",{staticClass:"col-4",attrs:{label:"國籍"}}),n("TCFormGroup",{staticClass:"col-6"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.records.document.signatory_nationality,expression:"\n                                        records.document\n                                            .signatory_nationality\n                                    "}],staticClass:"form-control",attrs:{placeholder:"國籍",disabled:""},domProps:{value:t.records.document.signatory_nationality},on:{input:function(e){e.target.composing||t.$set(t.records.document,"signatory_nationality",e.target.value)}}})])],1),n("div",{staticClass:"col-4 row"},[n("TCFormGroup",{staticClass:"col-4",attrs:{label:"擔保人",required:"",clickable_label:!0},nativeOn:{click:function(e){return t.showGuarantorProfile.apply(null,arguments)}}}),n("TCFormGroup",{staticClass:"col-6"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.records.document.guarantor_profile_name,expression:"\n                                        records.document\n                                            .guarantor_profile_name\n                                    "}],staticClass:"form-control",attrs:{placeholder:"擔保人",disabled:""},domProps:{value:t.records.document.guarantor_profile_name},on:{input:function(e){e.target.composing||t.$set(t.records.document,"guarantor_profile_name",e.target.value)}}})])],1)]),n("div",{staticClass:"subTitle justify-content-between"},[t._v("其他")]),n("div",{staticClass:"row gx-0 gy-1"},[n("div",{staticClass:"col-4 row"},[n("TCFormGroup",{staticClass:"col-4",attrs:{label:"追蹤狀態",required:""}}),n("TCFormGroup",{staticClass:"col-6"},[n("TCDropdown",{attrs:{allowEmpty:!1,options:t.track_status_option},model:{value:t.records.document.track_status,callback:function(e){t.$set(t.records.document,"track_status",e)},expression:"records.document.track_status"}})],1)],1),n("div",{staticClass:"col-4 row"}),n("div",{staticClass:"col-4 row"}),n("div",{staticClass:"col-4 row"},[n("TCFormGroup",{staticClass:"col-4",attrs:{label:"法律部備註"}}),n("TCFormGroup",{staticClass:"col-6"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.records.document.legal_department_remark,expression:"\n                                        records.document\n                                            .legal_department_remark\n                                    "}],staticClass:"form-control",attrs:{placeholder:"法律部備註"},domProps:{value:t.records.document.legal_department_remark},on:{input:function(e){e.target.composing||t.$set(t.records.document,"legal_department_remark",e.target.value)}}})])],1),n("div",{staticClass:"col-4 row"},[n("TCFormGroup",{staticClass:"col-4",attrs:{label:"中賬追蹤備註"}}),n("TCFormGroup",{staticClass:"col-6"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.records.document.center_remark,expression:"records.document.center_remark"}],staticClass:"form-control",attrs:{placeholder:"中賬追蹤備註"},domProps:{value:t.records.document.center_remark},on:{input:function(e){e.target.composing||t.$set(t.records.document,"center_remark",e.target.value)}}})])],1)])]),n("div",{staticClass:"tab-pane fade",attrs:{id:"step2"}},[n("div",{staticClass:"subTitle justify-content-between"},[t._v(" 選擇證件類型 ")]),n("div",{staticClass:"acc-image-area"},[n("div",{staticClass:"acc-image-btn-group"},[n("button",{staticClass:"btn acc-image-btn active"},[t._v(" 上傳文件 ")]),n("button",{staticClass:"add-acc-image-btn",on:{click:t.add_image_option}},[n("i",{staticClass:"fa fa-plus-circle"})])])]),n("div",{staticClass:"acc-image-area"},t._l(t.image_list,(function(e,a){return n("button",{key:a,ref:"picBtn"+a,refInFor:!0,staticClass:"btn acc-image-btn",class:{active:e.isClick},attrs:{accept:"image/png,image/gif,image/jpeg",name:"picBtn"+a,id:"picBtn"+a},on:{click:function(n){t.image_list.forEach((function(t){return t.isClick=!1})),e.isClick=!0,t.selectPicIndex=a}}},[n("span",{staticClass:"acc-image-delete-btn",on:{click:function(n){return t.delete_image_option(a,e)}}},[n("i",{staticClass:"fa fa-minus-circle"})]),t._v(" 文件"+t._s(a+1)+" ")])})),0),n("div",{staticClass:"subTitle justify-content-between"},[t._v(" 上傳證件並檢視 ")]),t._l(t.image_list,(function(e,s){return n("div",{key:s,staticClass:"row gx-0 justify-content-center"},[n("div",{directives:[{name:"show",rawName:"v-show",value:s==t.selectPicIndex&&t.image_list.length,expression:"\n                                index == selectPicIndex && image_list.length\n                            "}],staticClass:"col-6 image-area"},[n("button",{staticClass:"btn btn-new2 image-upload",attrs:{"data-loading-text":"Loading..."},on:{click:function(e){return t.clickFormInput(s)}}},[n("i",{staticClass:"fa fa-upload"}),t._v(" 上傳文件 ")]),n("form",{staticClass:"d-none",attrs:{id:"form"+s,enctype:"multipart/form-data"}},[n("input",{ref:"fileInput"+s,refInFor:!0,attrs:{type:"file",accept:"image/png, image/gif, image/jpeg"},on:{change:function(a){return t.showImg(a,s,e.id)}}})]),n("span",{staticClass:"image-clean-btn",on:{click:function(a){return t.clearInputImg(e,s)}}},[n("i",{staticClass:"fa fa-minus-circle"})]),n("div",{staticClass:"image-tips"},[t._v(" 支援JPEG, PNG, PDF.最大不可超過20MB ")]),e.src?n("img",{attrs:{src:e.src}}):n("img",{attrs:{src:a("f387")}})])])}))],2)])]},proxy:!0},{key:"footer",fn:function(){return[n("button",{staticClass:"btn btn-new4",attrs:{type:"button"},on:{click:function(e){return t.submit()}}},[t._v(" 保存 ")]),n("button",{staticClass:"btn btn-new4",attrs:{type:"button"},on:{click:function(e){return t.hide(0)}}},[t._v(" 離開 ")])]},proxy:!0}])}),n("SelectProfile",{ref:"signatoryProfile",on:{sendProfile:t.getSignatoryProfile}}),n("SelectProfile",{ref:"guarantorProfile",on:{sendProfile:t.getGuarantorProfile}})],1)},f=[],p=(a("1276"),a("b0c0"),a("5fec")),h=a("38f5"),g=a("8475"),v=a("c1df"),b=a.n(v),y=a("323e"),C=a.n(y),k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("TCModal",{ref:"modal",attrs:{id:"select_profile",title:t.UI.title,body_min_height:"fit-content",dialog_width:"600px"},scopedSlots:t._u([{key:"body",fn:function(){return[a("div",{staticClass:"align-items-center row container"},[t.profiles.length?a("table",{staticClass:"table table-hover"},[a("thead",[a("tr",[a("th",[t._v("姓名")]),a("th",[t._v("戶口角色")]),a("th",[t._v("出生年月日")])])]),a("tbody",t._l(t.profiles,(function(e,n){return a("tr",{key:n,staticStyle:{cursor:"pointer"},on:{click:function(a){return t.selectProfile(e)}}},[a("td",[t._v(t._s(e.name_full))]),a("td"),a("td",[t._v(t._s(e.solar_birthday))])])})),0)]):a("div",[t._v(" 請先輸入戶口編號 ")])])]},proxy:!0},{key:"footer",fn:function(){},proxy:!0}])})],1)},w=[],x={name:"select_profile",components:{TCModal:p["a"],TCFormGroup:h["a"]},data:function(){return{UI:{title:"簽署人"},profiles:[]}},methods:{selectProfile:function(t){this.$emit("sendProfile",t),this.hide()},hide:function(){return this.$refs.modal.hide()},show:function(t){return this.profiles=t,this.$refs.modal.show()}}},F=x,I=a("2877"),T=Object(I["a"])(F,k,w,!1,null,null,null),P=T.exports,S={getAccInfo:"/api/account-management/account/get-account-info",getAccDetail:"/api/account-management/account/detail",createLoanDoc:"/api/account-management/account-document/account-internal-document/create",updateLoanDoc:"/api/account-management/account-document/account-internal-document/update",detailLoanDoc:"/api/account-management/account-document/account-internal-document/detail"},G={name:"edit_form",components:{TCModal:p["a"],TCFormGroup:h["a"],TCDropdown:g["a"],SelectProfile:P},mounted:function(){},watch:{image_list:function(t,e){var a=this;0==t.length&&(this.selectPicIndex=0),t!=e&&this.image_list.forEach((function(t,e){t.isClick&&(a.selectPicIndex=e)}))}},data:function(){return{UI:{title:null,title_create:"新增內部文件",title_update:"修改內部文件"},is_create:!1,step_tab_list:[{id:"step1",title:"填寫資料"},{id:"step2",title:"上傳文件"}],track_status_option:[{name:"",value:0},{name:"已簽",value:1},{name:"未簽",value:2},{name:"無需跟進",value:3}],records:{document:{signed_date:"",duration:"",account_no:"",location_id:sessionStorage["location_id"],has_poa:1,has_transfer_record:1},files:{old_file_ids:[],new_files:[]}},image_list:[],selectPicIndex:0,profiles:[]}},methods:{getAccName:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.target.value&&this.getAccNameData(e.target.value);case 1:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getAccNameData:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,SysUI.axios("GET",S.getAccInfo,{account_no:e}).then(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,s,r,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(200!=(null===e||void 0===e?void 0:e.httpStatus)){t.next=7;break}return n=e.data,s=n.account_id,r=n.account_no,o=n.full_name,a.records.document=Object(i["a"])(Object(i["a"])({},a.records.document),{},{account_id:s,account_no:r,account_name:o}),t.next=5,SysUI.axios("GET",S.getAccDetail,{account_id:e.data.account_id}).then((function(t){var e=a.records.document;e.signatory_profile_name=e.signatory_profile_id=e.guarantor_profile_name=e.guarantor_profile_id="",a.profiles=t.data.record.profile,a.$forceUpdate()}));case 5:t.next=8;break;case 7:a.$message({top:1e3,showClose:!0,duration:500,message:null!==(c=null===e||void 0===e?void 0:e.message)&&void 0!==c?c:"讀取失敗",type:"error"});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),countDate:function(){var t=this.records.document.duration,e=this.records.document.signed_date;if(e){if(t>1e5)return SysUI.alert("新增內部文件","文件有效期不得超過100000",!0),void(t="");this.records.document.expired_date=b()(e).add(t,"days").format("YYYY-MM-DD");var a=b()(e).from(b()());a.includes("days ago")?this.records.document.expired_day=t-parseInt(a.split(" days ago")[0]):this.records.document.expired_day=t,this.$forceUpdate()}},showSignatoryProfile:function(){this.$refs.signatoryProfile.show(this.profiles)},showGuarantorProfile:function(){this.$refs.guarantorProfile.show(this.profiles)},getGuarantorProfile:function(t){this.records.document.guarantor_profile_name=t.name_full,this.records.document.guarantor_profile_id=t.profile_id,this.$forceUpdate()},getSignatoryProfile:function(t){this.records.document.signatory_profile_name=t.name_full,this.records.document.signatory_profile_id=t.profile_id,this.$forceUpdate()},add_image_option:function(){0==this.image_list.length?this.image_list.push({isClick:!0}):this.image_list.push({isClick:!1})},delete_image_option:function(t,e){this.is_create||_.remove(this.records.files.old_file_ids,(function(t){return e.id==t})),this.image_list.splice(t,1),console.log(" this.records.files",this.records.files)},clickFormInput:function(t){$(this.$refs["fileInput".concat(t)][0]).click()},clearInputImg:function(t,e){this.$refs["fileInput".concat(e)][0].value=null,this.image_list[e].src=null,console.log("image",t),this.is_create||_.remove(this.records.files.old_file_ids,(function(e){return t.id==e})),console.log("this.records.files",this.records.files),this.$forceUpdate()},showImg:function(t,e,a){var n=this;C.a.start(),this.is_create||_.remove(this.records.files.old_file_ids,(function(t){return a==t}));var s=new FileReader;s.readAsDataURL(t.target.files[0]),s.onload=function(t){n.image_list[e].src=t.target.result,n.$forceUpdate(),C.a.done()}},submit:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.records.document,t.next=3,this.validate(e);case 3:if(!t.sent){t.next=5;break}this.save();case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),validate:function(t){var e=[];if(t.account_no||e.push("戶口編號 "),t.doc_type||e.push("文件類型 "),t.amount||e.push("文件金額 "),t.track_status||e.push("追蹤狀態 "),e.length>0){var a="";return e.forEach((function(t){a+=t})),a+="不得為空",this.$message({top:1e3,showClose:!0,duration:5e3,message:a,type:"error"}),!1}return!0},save:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,n,s,i,o,c,l,d,u,m=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,SysUI.input_pin(!0);case 2:if(t.sent){t.next=4;break}return t.abrupt("return");case 4:for(l in i=[],o={"Content-Type":"multipart/form-data"},c=new FormData,this.records.document.location_id||(this.records.document.location_id=1),this.records.document)this.records.document[l]||0==this.records.document[l]?c.append("document[".concat(l,"]"),this.records.document[l]):delete this.records.document[l];return console.log("this.records",this.records),this.is_create?(e=S.createLoanDoc,a="POST",n="files"):(e=S.updateLoanDoc,a="PUT",n="files[new_files]",c.append("document_id",null!==(d=null===(u=this.records)||void 0===u?void 0:u.document_id)&&void 0!==d?d:""),this.records.files.old_file_ids.forEach((function(t,e){t&&c.append("files[old_file_ids][".concat(e,"]"),t)})),0!=this.records.file.length&&0!=this.records.files.old_file_ids.length||c.append("files[old_file_ids][]",[null])),this.image_list.forEach((function(t,e){var a,s;m.$refs["fileInput".concat(e)][0].files[0]&&(c.append("".concat(n,"[").concat(e,"]"),m.$refs["fileInput".concat(e)][0].files[0],null!==(a=null===(s=m.$refs["fileInput".concat(e)][0].files[0])||void 0===s?void 0:s.name)&&void 0!==a?a:""),i.push(e))})),i.length?s=c:(o={},s=this.records,c.append("files[]",[null])),t.next=13,SysUI.axios(a,e,s,o).then(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(200!=e.httpStatus){t.next=7;break}return t.next=3,m.hide();case 3:return t.next=5,m.$parent.search();case 5:t.next=8;break;case 7:m.$message({top:1e3,showClose:!0,duration:5e3,message:e.message,type:"error"});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),edit_record:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.record_init(),this.is_create=!1,this.UI.title=this.UI.title_update,this.records.document_id=e,t.next=6,SysUI.axios("GET",S.detailLoanDoc,{document_id:e}).then(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(200!=e.httpStatus){t.next=12;break}return a.records.document=e.data.document,a.records.file=e.data.file,a.records.files={old_file_ids:[],new_files:[]},e.data.file.forEach((function(t,e){var n=t.path,s=t.id;a.image_list[e]={isClick:0==e,src:n,id:s},a.records.files.old_file_ids.push(s)})),a.getAccNameData(e.data.document.account_no),a.countDate(),a.$forceUpdate(),console.log("this.records",a.records),t.abrupt("return",a.show());case 12:a.$message({top:1e3,showClose:!0,duration:5e3,message:e.message,type:"error"});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),create_record:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.record_init(),this.is_create=!0,this.UI.title=this.UI.title_create,this.user_group_id="",this.records.files=[],t.abrupt("return",this.show());case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),record_init:function(){this.records={document:{signed_date:"",duration:"",account_no:"",location_id:sessionStorage["location_id"],has_poa:1,has_transfer_record:1},files:{}},this.image_list=[],this.selectPicIndex=0},init_step_tab_list:function(){return $("#step1-tab").click()},show:function(){return this.init_step_tab_list(),this.$refs.modal.show()},hide:function(){return $(".main-tab-content").scrollTop(0),this.$refs.modal.hide()}}},j=G,E=(a("65ff"),Object(I["a"])(j,m,f,!1,null,null,null)),O=E.exports,D=a("9801"),U=function(){return[{label:D["a"].tc("acc_internal_doc.track_status"),key:"track_status",scale:1},{label:D["a"].tc("acc_internal_doc.account_no"),key:"account_no",scale:1},{label:D["a"].tc("acc_internal_doc.account_name"),key:"account_name",scale:1},{label:D["a"].tc("acc_internal_doc.doc_type"),key:"doc_type",scale:1},{label:D["a"].tc("acc_internal_doc.amount"),key:"amount",scale:1},{label:D["a"].tc("acc_internal_doc.signatory_name"),key:"signatory_name",scale:1},{label:D["a"].tc("acc_internal_doc.signatory_nationality"),key:"signatory_nationality",scale:1},{label:D["a"].tc("acc_internal_doc.effective_date"),key:"effective_date",scale:1},{label:D["a"].tc("acc_internal_doc.legal_department_remark"),key:"legal_department_remark",scale:1},{label:D["a"].tc("acc_internal_doc.center_remark"),key:"center_remark",scale:1},{label:D["a"].tc("acc_internal_doc.updated_by"),key:"updated_by",scale:1}]},R=U,N={getInternalList:"/api/account-management/account-document/account-internal-document/list"},q={name:"assistant",components:{FilterInputField:c["a"],FilterDateFiled:l["a"],FilterSelectField:d["a"],EditForm:O,FilterCustomization:u["a"]},data:function(){return{selected_index:[],fields:[],list:[],filters:{name:"",page:1,limit:20},hidden_fields:[],operation_width:"100px",permissions:[],track_status_options:[{value:0,text:""},{value:1,text:"已簽"},{value:2,text:"未簽"},{value:3,text:"到期待更新"},{value:4,text:"過期"},{value:5,text:"無需跟進"}]}},created:function(){this.getColumns(),this.permissions=getModulePermissions(),console.log("this.permissions",this.permissions)},computed:{get_operation_col_style:function(){return{width:this.operation_width}},filter_fields:function(){var t=this,e=this.fields,a=[];return e.forEach((function(e){t.hidden_fields.includes(e.key)||(a=[].concat(Object(o["a"])(a),[e]))})),a}},methods:{receiveMsg:function(t){console.log("handleMessageEvent",t)},pageSearch:function(t){this.filters=Object(i["a"])(Object(i["a"])({},this.filters),t),this.search()},getColumns:function(){this.fields=R()},getHiddenFields:function(t){this.hidden_fields=t},search:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,SysUI.input_pin(!0);case 2:if(t.sent){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,SysUI.axios("GET",N.getInternalList,this.filters).then((function(t){e.list=t.data.data,e.$refs.page.setDataFromAPI(t.data.pagination),e.selected_index=[]}));case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),sync_thead_scroll:function(){$(this.$refs.thead).scrollLeft($(this.$refs.tbody).scrollLeft())},select_display_fields:function(){this.$refs.displayColumn.show()},handle_acitve_tr:function(t){-1==this.selected_index.indexOf(t)?this.selected_index.push(t):this.selected_index.splice(this.selected_index.indexOf(t),1)},addInternal:function(){this.$refs.editForm.create_record()},edit:function(t){this.$refs.editForm.edit_record(t)}}},A=q,M=(a("6de5"),Object(I["a"])(A,n,s,!1,null,null,null));e["default"]=M.exports},b09a:function(t,e,a){},e31f:function(t,e,a){},f387:function(t,e,a){t.exports=a.p+"img/null_image.fca9848f.png"},f6e9:function(t,e,a){}}]);
//# sourceMappingURL=chunk-3ced8874.f9e91613.js.map